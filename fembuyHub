local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Fembuy Hub",
   Icon = 93059603763570,
   LoadingTitle = "Loading Hub",
   LoadingSubtitle = "by Manuel",
   Theme = "Default",
   ToggleUIKeybind = "K",
   ConfigurationSaving = {
      Enabled = true,
      FileName = "Fembuy Hub"
   },
   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },
   KeySystem = true,
   KeySettings = {
      Title = "Fembuy Hub",
      Subtitle = "Enter the key to proceed",
      Note = "Ask Manuel",
      FileName = "Key",
      SaveKey = true,
      Key = {"ilovefemboys"}
   }
})

Rayfield:Notify({
   Title = "Successful Execution",
   Content = "Fembuy Hub has loaded correctly.",
   Duration = 6.5,
   Image = 4483362458,
})

local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

local toggles = {
   InfYield = false,
   Invis = false,
   Phantasm = false,
   TSBExtra = false,
   Garden = false,
   ESPEnabled = false,
   TeleportLock = false
}

-- Function: Highlight (ESP) all players
local function highlightPlayers()
   for _, player in pairs(Players:GetPlayers()) do
      if player ~= localPlayer and player.Character then
         if not player.Character:FindFirstChild("ESPBox") then
            local highlight = Instance.new("Highlight")
            highlight.Name = "ESPBox"
            highlight.FillColor = Color3.fromRGB(255, 0, 255)
            highlight.FillTransparency = 0.6
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.OutlineTransparency = 0
            highlight.Adornee = player.Character
            highlight.Parent = player.Character
         end
      end
   end
end

-- Function: Kill all players (local damage, serverside better)
local function killAllPlayers()
   for _, player in pairs(Players:GetPlayers()) do
      if player ~= localPlayer and player.Character and player.Character:FindFirstChild("Humanoid") then
         player.Character.Humanoid:TakeDamage(9999)
      end
   end
end

-- Variables for teleport lock
local teleportEnabled = false
local offsetDistance = 10 -- studs in front of local player

-- Function to teleport and lock all players to a position in front of the local player
local function teleportAndLockPlayers()
   local localCharacter = localPlayer.Character
   if not localCharacter or not localCharacter:FindFirstChild("HumanoidRootPart") then
      return
   end

   local humanoidRootPart = localCharacter.HumanoidRootPart
   local localCFrame = humanoidRootPart.CFrame
   local offsetPosition = localCFrame.Position + (localCFrame.LookVector * offsetDistance)

   for _, player in pairs(Players:GetPlayers()) do
      if player ~= localPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
         local targetHumanoidRootPart = player.Character.HumanoidRootPart
         targetHumanoidRootPart.CFrame = CFrame.new(offsetPosition)
         targetHumanoidRootPart.Position = offsetPosition
      end
   end
end

-- Continuous teleport lock loop
spawn(function()
   while true do
      if teleportEnabled then
         teleportAndLockPlayers()
      end
      wait(0.1)
   end
end)

-- HOME TAB
local HomeTab = Window:CreateTab("Home", 17205450457)

HomeTab:CreateButton({
   Name = "Infinite Yield",
   Callback = function()
      if not toggles.InfYield then
         toggles.InfYield = true
         getgenv().infYield = loadstring(game:HttpGet("https://cdn.wearedevs.net/scripts/Infinite%20Yield.txt"))()
      else
         Rayfield:Notify({
            Title = "Already Loaded",
            Content = "Rejoin to disable Infinite Yield.",
            Duration = 4
         })
      end
   end,
})

-- PLAYER TAB
local PlayerTab = Window:CreateTab("Player", 17205450457)

PlayerTab:CreateButton({
   Name = "Invisible Script",
   Callback = function()
      if not toggles.Invis then
         toggles.Invis = true
         loadstring(game:HttpGet('https://pastebin.com/raw/3Rnd9rHf'))()
      end
   end,
})

PlayerTab:CreateSlider({
   Name = "WalkSpeed",
   Range = {0, 300},
   Increment = 1,
   Suffix = "Speed",
   CurrentValue = 16,
   Flag = "WalkSpeedSlider",
   Callback = function(value)
       local character = localPlayer.Character
       if character then
           local humanoid = character:FindFirstChildOfClass("Humanoid")
           if humanoid then
               humanoid.WalkSpeed = value
           end
       end
   end,
})

-- TSB TAB
local TSBTab = Window:CreateTab("TSB", 17205450457)

TSBTab:CreateButton({
   Name = "Phantasm Hub",
   Callback = function()
      if not toggles.Phantasm then
         toggles.Phantasm = true
         loadstring(game:HttpGet("https://raw.githubusercontent.com/ATrainz/Phantasm/main/Games/TSB.lua"))()
      end
   end,
})

TSBTab:CreateButton({
   Name = "Extra TSB Script",
   Callback = function()
      if not toggles.TSBExtra then
         toggles.TSBExtra = true
         loadstring(game:HttpGet("https://raw.githubusercontent.com/ATrainz/Phantasm/main/Games/TSB.lua"))()
      end
   end,
})

TSBTab:CreateButton({
   Name = "Highlight All Players",
   Callback = function()
      highlightPlayers()
      Rayfield:Notify({
         Title = "ESP Enabled",
         Content = "All players now highlighted.",
         Duration = 4
      })
   end,
})

-- This is your requested TP button creating the teleport GUI inside TSB tab
TSBTab:CreateButton({
    Name = "TP",
    Callback = function()
        local player = game.Players.LocalPlayer
        local playerGui = player:WaitForChild("PlayerGui")
        
        -- Avoid creating GUI twice
        if playerGui:FindFirstChild("TSBTeleportGui") then
            Rayfield:Notify({
                Title = "TP",
                Content = "Teleport GUI is already open.",
                Duration = 4
            })
            return
        end
        
        -- Create ScreenGui
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "TSBTeleportGui"
        screenGui.Parent = playerGui

        -- Create the toggle button (25x25)
        local toggleButton = Instance.new("TextButton")
        toggleButton.Size = UDim2.new(0, 25, 0, 25)
        toggleButton.Position = UDim2.new(0, 10, 0, 10)
        toggleButton.Text = "+"
        toggleButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        toggleButton.Parent = screenGui

        -- Create the main menu (hidden by default)
        local mainMenu = Instance.new("Frame")
        mainMenu.Size = UDim2.new(0, 400, 0, 400)
        mainMenu.Position = UDim2.new(0.5, -200, 0.5, -200)
        mainMenu.BackgroundTransparency = 0.5
        mainMenu.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        mainMenu.Visible = false
        mainMenu.Parent = screenGui

        -- Create 8 buttons and labels in the main menu
        local labels = {
            "Main Map", "Mountain 1", "Mountain 2", "Death counter room",
            "Atomic slash room", "Upper baseplate", "Lower baseplate", "Void"
        }

        local buttons = {}
        for i = 1, 8 do
            -- Create button
            local button = Instance.new("TextButton")
            button.Size = UDim2.new(0, 100, 0, 50)
            button.Position = UDim2.new(0, (i-1)%4 * 105, 0, math.floor((i-1)/4) * 55 + 75)
            button.Text = ""
            button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            button.Parent = mainMenu

            -- Create label for button
            local label = Instance.new("TextLabel")
            label.Size = UDim2.new(1, 0, 1, 0)
            label.Text = labels[i]
            label.TextColor3 = Color3.fromRGB(0, 0, 0)
            label.BackgroundTransparency = 1
            label.TextSize = 10
            label.Parent = button

            table.insert(buttons, button)
        end

        -- Function to toggle the visibility of the main menu
        local function toggleMenu()
            mainMenu.Visible = not mainMenu.Visible
        end

        -- Connect the toggle button to the toggleMenu function
        toggleButton.MouseButton1Click:Connect(toggleMenu)

        -- Function to teleport the player
        local function teleportToPosition(position)
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(position)
            end
        end

        -- Teleportation for the 8 buttons
        local originalPosition = nil
        local baseplateCreated = false

        buttons[1].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(219.81, 437.76, -62.96)) -- Main Map coordinates
        end)

        buttons[2].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(-100.45, 649.84, -381.81)) -- Mountain 1 coordinates
        end)

        buttons[3].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(343.55, 696.10, 370.36)) -- Mountain 2 coordinates
        end)

        buttons[4].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(-35.38, 34.95, 20348.53)) -- Death counter room coordinates
        end)

        buttons[5].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(1086.53, 142.31, 23007.97)) -- Atomic slash room coordinates
        end)

        buttons[6].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(1163.84, 402.99, 22901.67)) -- Upper baseplate coordinates
        end)

        buttons[7].MouseButton1Click:Connect(function()
            teleportToPosition(Vector3.new(1144.79, 16.93, 22928.82)) -- Lower baseplate coordinates
        end)

        buttons[8].MouseButton1Click:Connect(function()
            if originalPosition == nil then
                originalPosition = player.Character.HumanoidRootPart.Position
                teleportToPosition(Vector3.new(-6896.53, 873.40, -6729.34)) -- Void coordinates
                
                if not baseplateCreated then
                    local baseplate = Instance.new("Part")
                    baseplate.Size = Vector3.new(100, 1, 100)  -- 100x100 baseplate
                    baseplate.Position = Vector3.new(-6896.53, 871.40, -6729.34)  -- 2 studs below the Void position
                    baseplate.Anchored = true
                    baseplate.Parent = workspace
                    baseplateCreated = true
                end
            else
                teleportToPosition(originalPosition)
                originalPosition = nil
            end
        end)
    end,
})

-- GARDEN TAB
local GardenTab = Window:CreateTab("Grow a Garden", 17205450457)

GardenTab:CreateButton({
   Name = "Garden Script",
   Callback = function()
      if not toggles.Garden then
         toggles.Garden = true
         loadstring(game:HttpGet("https://pastebin.com/raw/Wx1jLMxt"))()
      end
   end,
})

-- ESP TAB
local ESPTab = Window:CreateTab("ESP", 17205450457)

ESPTab:CreateToggle({
   Name = "Enable ESP",
   CurrentValue = false,
   Flag = "EnableESP",
   Callback = function(value)
      toggles.ESPEnabled = value
      if value then
         highlightPlayers()
      else
         -- Remove ESP highlights
         for _, player in pairs(Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("ESPBox") then
               player.Character.ESPBox:Destroy()
            end
         end
      end
   end,
})

-- MISC TAB
local MiscTab = Window:CreateTab("Misc", 17205450457)

MiscTab:CreateButton({
   Name = "Kill All Players",
   Callback = function()
      killAllPlayers()
   end,
})

return Rayfield
